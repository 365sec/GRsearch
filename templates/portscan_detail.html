<html lang="en">
	{% load staticfiles %}
	<head>
		<title>{{ metainfo.ip }}</title>
		<meta charset="utf-8">
		<!-- <link rel="stylesheet" href="https://static.shodan.io/bootstrap/css/bootstrap.css">
		<link rel="stylesheet" href="https://static.shodan.io/font-awesome-4.2.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="https://static.shodan.io/jquery/css/jquery-jvectormap-1.2.2.css">
		<link rel="stylesheet" href="https://static.shodan.io/shodan/css/base-styles.css">
		<link rel="stylesheet" href="https://static.shodan.io/shodan/css/shodan.css">
		<link rel="stylesheet" href="https://static.shodan.io/mapbox/css/mapbox.css"> -->
		<link rel="stylesheet" href="{% static 'css/host/bootstrap.css' %}">
		<link rel="stylesheet" href="{% static 'css/host/font-awesome.min.css' %}">
		<link rel="stylesheet" href="{% static 'css/host/jquery-jvectormap-1.2.2.css' %}">
		<link rel="stylesheet" href="{% static 'css/host/base-styles.css' %}">
		<link rel="stylesheet" href="{% static 'css/host/shodan.css' %}">
		<link rel="stylesheet" href="{% static 'css/host/mapbox.css' %}">
		<style>
            pre {outline: 1px solid #ccc; padding: 5px; margin: 5px; }
            .string { color: green; }
            .number { color: darkorange; }
            .boolean { color: blue; }
            .null { color: magenta; }
            .key { color: red; }
        </style>
	</head>
	<body class="">
		<div class="container-fluid">
			<div class="row-fluid">
				<div class="host">
					<div class="row-fluid">
						<div class="span6">
							<div class="page-header">
								<h2><i class="fa fa-globe"></i>{{ metainfo.ip }} </h2>
								{% for hit in port_list %}
								<span class="badge badge-inverse">{{ hit.protocol }} </span>
								{% endfor %}
							</div>
							<table class="table">
								<tbody>
									<tr>
										<td>城市</td>
										<th>{{ metainfo.city }}</th>
									</tr>
									<tr>
										<td>省份地区</td>
										<th>{{ metainfo.province }}</th>
									</tr>
									<tr>
										<td>国家</td>
										<th>{{ metainfo.country }}</th>
									</tr>
									<tr>
										<td>经度</td>
										<th>{{ metainfo.longitude }}</th>
									</tr>
									<tr>
										<td>维度</td>
										<th>{{ metainfo.latitude}}</th>
									</tr>
								</tbody>
							</table>

						</div>
						<div class="span6">
							<div class="page-header">
								<h2><i class="fa fa-th-large"></i>Ports </h2>
							</div>
							<ul class="ports">
								{% for hit in port_name_list %}
								<li>
									<a href="#{{ hit }}">{{ hit }}</a>
								</li>
								{% endfor %}
							</ul>
							<div style="clear:both"></div>
							<div class="page-header">
								<h2><i class="fa fa-th-list"></i>Services </h2>
							</div>
							<ul class="services">
								{% for hit in port_list %}
								{% ifequal hit.protocol 'http' %}
								<li class="service service-long">
									<a name="{{ hit.port}}"></a>
									<div class="service-details">
										<div class="port">
											{{ hit.port }}
										</div>
										<div class="protocol">
											{{ hit.protocol }}
										</div><a href="http://{{ metainfo.ip }}:{{ hit.port }}" target="_blank" class="link"><i class="fa fa-mail-forward">&nbsp; </i></a>
									</div>
									<div class="service-main">
										<li><h3>headers</h3>
										<pre deep="8">{{ hit.headers}}</pre>
										<h3>body</h3>
										<pre deep="8">{{ hit.body}}</pre></li>
										<div class="clear"></div>
									</div>
								</li>
								{% endifequal %}
								{% ifequal hit.protocol 'https' %}
								<li class="service service-long">
									<a name="{{ hit.port}}"></a>
									<div class="service-details">
										<div class="port">
											{{ hit.port }}
										</div>
										<div class="protocol">
											{{ hit.protocol }}
										</div>
									</div>
									<div class="service-main">
										<li><h3>tls</h3>
										<pre deep="8">{{ hit.tls}}</pre></li>
										<div class="clear"></div>
									</div>
								</li>
								{% endifequal %}
								{% ifequal hit.protocol 'ssh' %}
								<li class="service service-long">
									<a name="{{ hit.port}}"></a>
									<div class="service-details">
										<div class="port">
											{{ hit.port }}
										</div>
										<div class="protocol">
											{{ hit.protocol }}
										</div>
									</div>
									<div class="service-main">
										<li><h3>banner_data</h3>
										<pre deep="8">{{ hit.banner_data}}</pre></li>
										<div class="clear"></div>
									</div>
								</li>
								{% endifequal %}
								{% ifequal hit.protocol 'ftp' %}
								<li class="service service-long">
									<a name="{{ hit.port}}"></a>
									<div class="service-details">
										<div class="port">
											{{ hit.port }}
										</div>
										<div class="protocol">
											{{ hit.protocol }}
										</div>
									</div>
									<div class="service-main">
										<li><h3>banner_data</h3>
										<pre deep="8">{{ hit.banner_data}}</pre></li>
										<div class="clear"></div>
									</div>
								</li>
								{% endifequal %}
								{% ifnotequal hit.protocol 'http' %}
								{% ifnotequal hit.protocol 'https' %}
								{% ifnotequal hit.protocol 'ssh' %}
								{% ifnotequal hit.protocol 'ftp' %}
								<li class="service service-long">
									<a name="{{ hit.port}}"></a>
									<div class="service-details">
										<div class="port">
											{{ hit.port }}
										</div>
										<div class="protocol">
											{{ hit.protocol }}
										</div>
									</div>
									<div class="service-main">
										<li><h3>data</h3>
										<pre deep="8">
											<div id="json_data">
											  {{ hit.data}}
											</div>
										</pre></li>
										<div class="clear"></div>
									</div>
								</li>
								{% endifnotequal %}
								{% endifnotequal %}
								{% endifnotequal %}
								{% endifnotequal %}
								{% endfor %}
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="footer muted">
			<p>
				portscan扫描
			</p>
		</div>
	</body>
	<script type="text/javascript">
	    function load(){
	    	var json = document.getElementById("json_data").innerText;
	    	if (typeof json != 'string') {
                json = JSON.stringify(json, undefined, 2);
            }
	    	var data = "<p>";
            json = json.replace(/&/g, '&').replace(/</g, '<').replace(/>/g, '>');
            json = json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function(match) {
            	    var cls = 'number';
            	    if (/^"/.test(match)) {
            	    	if (/:$/.test(match)) {
            	    		cls = 'key';
            	    	} else {
            	    		cls = 'string';
            	    	}
            	    } else if (/true|false/.test(match)) {
            	    	cls = 'boolean';
            	    } else if (/null/.test(match)) {
            	    	cls = 'null';
            	    }
            	    return '<span class="' + cls + '">' + match + '</span>';
            	   });
            data += json;
            data = data + "</p>";
            document.getElementById("json_data").innerHTML = data; 
	    }
	</script>
</html>